************************
* GGS ANALYSIS EXAMPLE *
************************

This example shows how to run a simple MonteCarlo simulation with GGSPenny and how to process data in offline analysis.
It uses the geometry defined in the geometry example, which has to be built before launching the simulation. Please refer
to the README file of the geometry example for instructions.

++++++++++
+ MC RUN +
++++++++++

The run.sh script contains the launch instructions for GGSPenny. It has some parameters which must be initialized:

  PENNY: path to the GGSPenny executable. It can be found in the src/montecarlo/ subfolder of the GGS build directory.
         If GGS has been installed with make install, the installed version of GGSPenny can be used by omitting the path and
         setting PENNY=GGSPenny
  GEOMETRY: path to the libGeoExample.so library. It can be found inside the geometry example build directory.
  DATACARD: the datacard with the simulation commands.
  OUTPUT: desired name for the ROOT output file.
  
The provided datacard named TestRun.mac sets the gun generator to produce 10 GeV electrons at Z=30 cm, directed towards
negative Z with a random angle -30 deg < theta < 30 deg with respect to Z axis, with a cylindrically symmetric distribution 
along that axis (0 < phi < 360). Only particles inside the acceptance will be simulated. Then two standard GGS hits sensitive
detectors are added to both cube1 and cube2, with detector for cube1 storing also particle hits (warning: DON'T turn on the
storage of particle hits for cube2: it is made of BGO so electromagnetic showers will initiate and develop in it. Recording
the hit of each single particle of the shower will slow down the simulation and produce an oversized output file). It then
adds actions for recording the MC truth and hits on the ROOT file (no output will be produced if these lines are commented out)
and finally 1000 particles are shot.

The simulation can be run by simply launching the run.sh script after properly setting the parameters described above.


++++++++++++
+ ANALYSIS +
++++++++++++

A sample ROOT analysis script called anlysis.cpp is provided. The script has some parameters to be set:

  dictName: the path to the libGGSReader.so library containing the reader and the relative ROOT dictionaries. The library is 
            part of GGS and can be found either in the src/montecarlo/readers/ subfolder of the GGS build directory or in the
            lib/ subfolder of the GGS installation directory.
  fileName: the path to the output file generated by GGSPenny.
  cube1Size: the size of cube1.
  primaryEnergy: the energy of the primary particle.
  
The script will produce a plot of the sum of energy releases in the two cubes for particles inside acceptance and a graph of 
intersection points between the trajectories and the Z=0 plane, for every particle (inside or outside acceptance). In the latter
graph, red points are for trajectories impacting on the upstream face of cube1, while black are the ones missing it. Notice that
if the acceptance control has been enabled in the datacard, then only red points will populate the plot. 